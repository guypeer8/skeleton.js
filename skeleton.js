var Skeleton=function(){function t(e){function r(t){var r=Object.assign({},e.defaults)||{};this.get=function(t){return r[t]||null},this.set=function(){if(2===arguments.length)r[arguments[0]]=arguments[1];else{if(1!==arguments.length)throw Error("Error on setting a value");var t=arguments[0];for(var e in t)r[e]=t[e]}},this.toJSON=function(){return r};for(var n in t)this.set(n,t[n]);e&&e.init&&e.init.call(this)}if(!(this instanceof t))return new t(e);for(var n in e)"init"!==n&&"defaults"!==n&&(r.prototype[n]=e[n]);return r}function e(t){function r(){function e(t){"number"==typeof t?r.splice(t,1):r=r.filter(function(e){return e!==t})}var r=[],n=t&&t.model;this.add=function(t){if(!(t instanceof n))throw Error("A collection must consist of models of same instance");r.push(t)},this.removeByFields=function(t){r=r.filter(function(e){for(var r in t)if(e.get(r)!==t[r])return!0;return!1})},this.remove=function(){if(1===arguments.length)e(arguments[0]);else for(var t=0;t<arguments.length;t++)e(arguments[t])},this.removeAll=function(){r=[]},this.models=function(){return r},this.filterToJSON=function(t){var e=this.toJSON();for(var r in t)e=e.filter(function(e){return e[r]===t[r]});return e},this.toJSON=function(){return r.map(function(t){return t.toJSON()})},t&&t.init&&t.init.call(this)}return this instanceof e?r:new e(t)}function r(t){function n(t){p.innerHTML=o(t)}function i(t){"all"!==t&&t?"push"===t?h.filter(function(t){return"remove"!==t.type}).forEach(function(t){t.listener()}):h.filter(function(t){return"push"!==t.type}).forEach(function(t){t.listener()}):h.forEach(function(t){t.listener()})}function o(t){var e=t||g.toJSON();e.forEach(function(t){t.index=f()});var r="";return e.forEach(function(t){r+=s(t)}),r}function s(t){var e=l;return e=e.replace(a,function(e,r){if(-1!==r.indexOf("|")){var n=r.split("|"),i=n[0].trim(),o=n[1].trim(),s=u(t,i);if(!s)throw Error('Please check the expression "'+i+'" you passed in the template');if("upper"===o)return s.toUpperCase();if("lower"===o)return s.toLowerCase();if("capitalize"===o)return s.charAt(0).toUpperCase()+s.slice(1).toLowerCase();if("currency"===o)return"$"+s;if("json"===o){try{s=JSON.stringify(s)}catch(f){throw Error("The argument passed can not be stringified to a json string")}return s}throw Error("The filter you are using is not supported. Please write to guypeer8@gmail.com to get support to what you need")}return u(t,r)})}function u(t,e){var r=e.split(".");if(1===r.length)return t[e];for(var n=t[r[0].trim()],i=1;i<r.length;i++)n=n[r[i].trim()];return n}function f(){return c++}if(!(this instanceof r))return new r(t);var l,a=/{{\s*((\w+\.*\w+)*\s*\|?\s*\w+)\s*}}/g,c=-1,h=[],m=t&&t.model,p=document.getElementById(t&&t.element),d=t&&t.template;if("string"==typeof d)l=d;else if("object"==typeof d){if(!d.templateId)throw Error('Template must be a string, or an object with "templateId" field');l=document.getElementById(d.templateId).innerHTML}if(!m)throw Error("A model must be supplied");if(!p)throw Error("An element must be supplied, provided by its id");if(!l)throw Error("A template must be supplied");var g=new new e({model:m});this.getCollection=function(){return g},this.models=function(){return g.toJSON()},this.updateView=n,this.renderAll=function(){n()},this.pushAll=function(t){t.forEach(function(t){g.add(new m(t))}),n(),i("push")},this.push=function(t){g.add(t instanceof m?t:new m(t)),n(),i("push")},this.removeByFields=function(t){g.removeByFields(t),n(),i("remove")},this.remove=function(t){for(var e=this.models(),r=0;r<e.length;r++){var o=e[r];if(o.index===t){g.remove(r);break}}return n(),i("remove"),e[r]},this.removeAll=function(){g.removeAll(),n(),i("remove")},this.get=function(t){for(var e=this.models(),r=0;r<e.length;r++){var n=e[r];if(n.index===t)return n}},this.size=function(){return this.models().length},this.filter=function(t){var e=g.filterToJSON(t);n(e)},this.subscribe=function(){if(1===arguments.length&&"function"==typeof arguments[0])h.push({type:"all",listener:arguments[0]});else{if(2!==arguments.length)throw Error('You should pass a callback function or a type "push" or "remove" and a callback to subscribe');var t=arguments[0];if(listener=arguments[1],"push"===t)h.push({type:"push",listener:listener});else{if("remove"!==t)throw Error('type of listener must be "push" or "remove"');h.push({type:"remove",listener:listener})}}}}return{Model:t,List:r}}();