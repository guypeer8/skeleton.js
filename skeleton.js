"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},Skeleton=function(){function t(e){function n(t){var n=Object.assign({},e.defaults)||{};this.get=function(t){return n[t]||null},this.set=function(){if(2===arguments.length)n[arguments[0]]=arguments[1];else{if(1!==arguments.length)throw new Error("Error on setting a value");var t=arguments[0];for(var e in t)n[e]=t[e]}},this.toJSON=function(){return n};for(var r in t)this.set(r,t[r]);e&&e.init&&e.init.call(this)}if(!(this instanceof t))return new t(e);for(var r in e)"init"!==r&&"defaults"!==r&&(n.prototype[r]=e[r]);return n}function e(t){function n(e){function n(t){"number"==typeof t?r.splice(t,1):r=r.filter(function(e){return e!==t})}var r=[],i=t&&t.model;this.add=function(t){if(!(t instanceof i))throw new Error("A collection must consist of models of same instance");r.push(t)},this.removeByFields=function(t){r=r.filter(function(e){for(var n in t)if(e.get(n)!==t[n])return!0;return!1})},this.remove=function(){if(1===arguments.length)n(arguments[0]);else for(var t=0;t<arguments.length;t++)n(arguments[t])},this.removeAll=function(){r=[]},this.models=function(){return r},this.filterToJSON=function(t,e){var n=this.toJSON();if(e){var r=function(r){n=n.filter(function(n){return e.call(n[r],t[r])})};for(var i in t)r(i)}else{var o=function(e){n=n.filter(function(n){return n[e]===t[e]})};for(var u in t)o(u)}return n},this.toJSON=function(){return r.map(function(t){return t.toJSON()})},t&&t.init&&t.init.call(this)}return this instanceof e?n:new e(t)}function n(t){function r(t){"all"!==t&&t?"push"===t?h.filter(function(t){return"remove"!==t.type}).forEach(function(t){return t.listener()}):h.filter(function(t){return"push"!==t.type}).forEach(function(t){return t.listener()}):h.forEach(function(t){return t.listener()})}function i(t){d.innerHTML=o(t)}function o(t){var e=t||w.toJSON();e.forEach(function(t){return t.index=a()});var n="";return e.forEach(function(t){return n+=u(t)}),n}function u(t){var e=v;return e=e.replace(l,function(e,n){return-1!==n.indexOf("|")?s(t,n):f(t,n)})}function s(t,e){var n=e.split("|"),r=n[0].trim(),i=n[1].trim(),o=f(t,r);if(!o)throw new Error('Please check the expression "'+r+'" you passed in the template');if(m[i])return m[i](o);throw new Error('The filter you are using does not exist. Please use "addFilter" function to create it.')}function f(t,e){var n=e.split(".");if(1===n.length)return t[e];for(var r=t[n[0].trim()],i=1;i<n.length;i++)r=r[n[i].trim()];return r}function a(){return c++}if(!(this instanceof n))return new n(t);var l=/{{\s*((\w+\.?\w+?)*\s*\|?\s*\w+)\s*}}/g,c=0,h=[],m={upper:function(t){return t.toUpperCase()},lower:function(t){return t.toLowerCase()},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},currency:function(t){return"$"+t},json:function(t){try{t=JSON.stringify(t)}catch(e){throw new Error("The argument passed can not be stringified to a json string")}return t}},p=t&&t.model,d=document.getElementById(t&&t.element),v=void 0,g=t&&t.template;if("string"==typeof g)v=g;else if("object"===("undefined"==typeof g?"undefined":_typeof(g))){if(!g.templateId)throw new Error('Template must be a string, or an object with "templateId" field');v=document.getElementById(g.templateId).innerHTML}if(!p)throw new Error("A model must be supplied");if(!d)throw new Error("An element must be supplied, provided by its id");if(!v)throw new Error("A template id or string must be supplied");var w=new new e({model:p});this.getCollection=function(){return w},this.models=function(){return w.toJSON()},this.updateView=i,this.pushAll=function(t){t.forEach(function(t){w.add(new p(t))}),i(),r("push")},this.push=function(t){t instanceof p?w.add(t):w.add(new p(t)),i(),r("push")},this.remove=function(t){for(var e=this.models(),n=0;n<e.length;n++){var o=e[n];if(o.index===t){w.remove(n);break}}return i(),r("remove"),e[n]},this.removeByFields=function(t){w.removeByFields(t),i(),r("remove")},this.removeAll=function(){w.removeAll(),i(),r("remove")},this.get=function(t){for(var e=this.models(),n=0;n<e.length;n++){var r=e[n];if(r.index===t)return r}},this.size=function(){return this.models().length},this.filter=function(t,e){var n=w.filterToJSON(t,e);return i(n),n},this.addFilter=function(t,e){if("string"!=typeof t)throw new Error("Filter name must be a string");if("function"!=typeof e)throw new Error("Filter callback must be a function");m[t]=e},this.subscribe=function(){if(1===arguments.length&&"function"==typeof arguments[0])h.push({type:"all",listener:arguments[0]});else{if(2!==arguments.length)throw new Error('You should pass a callback function or a type "push" or "remove" and a callback to subscribe');var t=arguments[0],e=arguments[1];if("push"===t)h.push({type:"push",listener:e});else{if("remove"!==t)throw new Error('type of listener must be "push" or "remove"');h.push({type:"remove",listener:e})}}}}return{Model:t,List:n}}();